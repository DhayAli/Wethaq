<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>بحث ملفات المركز</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .no-results {
            color: red;
            font-weight: bold;
            text-align: center;
            margin-top: 20px;
        }
    </style>
</head>

<body class="bg-light">
    <div class="container mt-5">
        <h1 class="text-center mb-4">بحث في ملفات هذا المركز</h1>

        <form id="searchForm" class="mb-4">
            <div class="row justify-content-center">
                <div class="col-md-8">
                    <div class="input-group">
                        <input type="text" id="search_keyword" class="form-control"
                            placeholder="أدخل الاسم أو رقم الهوية" required>
                        <button type="button" id="searchButton" class="btn btn-primary">بحث</button>
                    </div>
                </div>
            </div>
        </form>

        <div id="errorMessage" class="text-danger text-center mt-2 d-none">يرجى إدخال الاسم أو رقم الهوية للبحث.</div>



        <!-- رسالة عند عدم وجود نتائج -->
        <div id="noResults" class="no-results d-none">لا توجد نتائج مطابقة.</div>

        <!-- جدول عرض النتائج -->
        <table class="table table-bordered d-none" id="resultsTable">
            <thead class="table-light">
                <tr>
                    <th>رقم الملف</th>
                    <th>اسم الموقوف</th>
                    <th>تفاصيل القضية</th>
                    <th>حالة القضية</th>
                    <th>الإجراءات</th>
                </tr>
            </thead>
            <tbody id="resultsBody">
                <!-- سيتم إدراج الصفوف هنا ديناميكيًا -->
            </tbody>
        </table>
    </div>

    <!-- نافذة منبثقة للتفاصيل -->
    <div class="modal fade" id="fileDetailsModal" tabindex="-1" aria-labelledby="fileDetailsModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="fileDetailsModalLabel">تفاصيل الملف</h5>
                </div>
                <div class="modal-body" id="modalBody">
                    <!-- سيتم ملء التفاصيل هنا -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">إغلاق</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const searchKeyword = document.getElementById("search_keyword");
        const resultsTable = document.getElementById("resultsTable");
        const noResults = document.getElementById("noResults");
        const resultsBody = document.getElementById("resultsBody");
        const searchButton = document.getElementById("searchButton"); // زر البحث
        const errorMessage = document.getElementById("errorMessage"); // رسالة الخطأ

        // البيانات المحاكية
        const database = [
            {
                fileId: 4001,
                name: "يوسف حسن",
                caseDetails: "قضية اعتداء",
                caseStatus: "قيد المعالجة",
                birthDate: "1990-01-01",
                nationality: "سعودي",
                address: "الرياض",
                phone: "0501234567",
                idType: "بطاقة هوية وطنية",
                accusation: "اعتداء",
                arrestAgency: "شرطة الرياض",
                arrestLocation: "الرياض",
                arrestDate: "2023-12-01",
                caseNumber: "123456",
                detentionAgency: "النيابة العامة",
            },
            {
                fileId: 4002,
                name: "سارة أحمد",
                caseDetails: "قضية سرقة",
                caseStatus: "مغلقة",
                birthDate: "1985-06-15",
                nationality: "سعودية",
                address: "جدة",
                phone: "0559876543",
                idType: "بطاقة هوية وطنية",
                accusation: "سرقة",
                arrestAgency: "شرطة جدة",
                arrestLocation: "جدة",
                arrestDate: "2023-11-01",
                caseNumber: "654321",
                detentionAgency: "النيابة العامة",
            },
        ];

        // دالة البحث
        function search(keyword) {
            const trimmedKeyword = keyword.trim().toLowerCase();

            if (trimmedKeyword === "") {
                resultsBody.innerHTML = "";
                resultsTable.classList.add("d-none");
                noResults.classList.add("d-none");
                return;
            }

            const results = database.filter(
                (record) =>
                    record.name.toLowerCase().includes(trimmedKeyword) ||
                    String(record.fileId).includes(trimmedKeyword)
            );

            resultsBody.innerHTML = "";

            if (results.length > 0) {
                resultsTable.classList.remove("d-none");
                noResults.classList.add("d-none");

                results.forEach((result) => {
                    const row = `<tr>
                <td>${result.fileId}</td>
                <td>${result.name}</td>
                <td>${result.caseDetails}</td>
                <td>${result.caseStatus}</td>
                <td><button class="btn btn-sm btn-info" onclick="showDetails(${result.fileId})">عرض</button></td>
            </tr>`;
                    resultsBody.innerHTML += row;
                });
            } else {
                resultsTable.classList.add("d-none");
                noResults.classList.remove("d-none");
                noResults.textContent = "لا توجد نتائج مطابقة.";
            }
        }

        // ربط البحث بزر البحث
        searchButton.addEventListener("click", function () {
            const keyword = searchKeyword.value.trim();
            if (keyword === "") {
                // إذا كان الحقل فارغًا، أظهر رسالة خطأ
                errorMessage.classList.remove("d-none");
            } else {
                // إذا كان الحقل يحتوي على قيمة، قم بإخفاء رسالة الخطأ
                errorMessage.classList.add("d-none");
                search(keyword); // نفذ البحث
            }
        });

        // البحث أثناء الكتابة
        searchKeyword.addEventListener("input", function () {
            const keyword = searchKeyword.value.trim();
            errorMessage.classList.add("d-none"); // إخفاء رسالة الخطأ أثناء الكتابة
            search(keyword);
        });

        // عرض التفاصيل في النافذة المنبثقة
        function showDetails(fileId) {
            const record = database.find((item) => item.fileId === fileId);
            if (record) {
                const modalBody = document.querySelector("#fileDetailsModal .modal-body");
                modalBody.innerHTML = `
            <p><strong>رقم الملف:</strong> ${record.fileId}</p>
            <p><strong>الاسم:</strong> ${record.name}</p>
            <p><strong>تفاصيل القضية:</strong> ${record.caseDetails}</p>
            <p><strong>حالة القضية:</strong> ${record.caseStatus}</p>
            <p><strong>تاريخ الميلاد:</strong> ${record.birthDate}</p>
            <p><strong>الجنسية:</strong> ${record.nationality}</p>
            <p><strong>نوع الهوية:</strong> ${record.idType}</p>
            <p><strong>التهمة:</strong> ${record.accusation}</p>
            <p><strong>جهة القبض:</strong> ${record.arrestAgency}</p>
            <p><strong>مكان القبض:</strong> ${record.arrestLocation}</p>
            <p><strong>تاريخ القبض:</strong> ${record.arrestDate}</p>
            <p><strong>العنوان:</strong> ${record.address}</p>
            <p><strong>رقم الهاتف:</strong> ${record.phone}</p>
            <p><strong>رقم القضية:</strong> ${record.caseNumber}</p>
            <p><strong>جهة التوقيف:</strong> ${record.detentionAgency}</p>
        `;
                const fileDetailsModal = new bootstrap.Modal(document.getElementById("fileDetailsModal"));
                fileDetailsModal.show();
            }
        }


    </script>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>